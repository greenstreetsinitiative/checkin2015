{% extends "base.html" %}
{% load i18n %}
{% load staticfiles %}

{% block title %}Check-in your commute to work!{% endblock %}

{% block style %}
<link rel="stylesheet" href="{% static 'libs/chosen/chosen.min.css' %}">
{% endblock %}

{% block javascript %}

<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script src="{% static 'libs/jquery.formset.js' %}" type="text/javascript"></script>
<script src="{% static 'libs/chosen/chosen.jquery.min.js' %}" type="text/javascript"></script>
<script src="{% static 'js/form.js' %}" type="text/javascript"></script>

{% endblock %}

{% block body %}

<div class="row">
  <center>
    <h1>Walk/Ride Day Check-In</h1>
    <h2>{{ wr_day }}</h2>
    <p class="lead">Walk/Ride Days happen on the last Friday of every month, and the Corporate Challenge takes place April through October. Donâ€™t work on Fridays? Check in your commute for another day! You can check in as early as the Monday prior or as late as the Monday after.</p>
    <div class="panel panel-danger browser"><p class="text-danger"><strong>We strongly recommend</strong> using an up-to-date Internet browser such as Internet Explorer 8 or later, <a href="http://www.google.com/chrome/">Google Chrome</a> or <a href="https://www.mozilla.org/en-US/firefox/new/">Mozilla Firefox</a> if you have trouble checking in with multiple commute segments. As another alternative, you may also use your smartphone to check in!</p></div>
  </center>
</div>
<hr class="green-big">
{% if form.errors or WRFW_formset.errors or WRTW_formset.errors or NormalFW_formset.errors or NormalTW_formset.errors %}
  <div class="alert alert-danger" role="alert"><center>Oops! Please finish completing your checkin.</center></div>
{% endif %}

<form name="form" method="post" action="{{request.path}}" class="form-horizontal">
  <fieldset>
  {% csrf_token %}
    {{ form.non_field_errors }}
    {% for field in form %}
      <div class="form-group {% if field.errors %}has-error{% endif %}">
        <div class="col-sm-5">
          {{ field.label_tag }}
        </div>
        <div class="col-sm-7">
          {{ field }}
          {% if field.help_text %}
              <span style="font-family: 'Alegreya Sans';">{{ field.help_text }}</span>
          {% endif %}
          {% if field.errors %}
            <div class="help-block">
            {% for error in field.errors %}
              {{ error|escape }}<br>
            {% endfor %}
            </div>
          {% endif %}
        </div>

      </div>
    {% endfor %}

    <div>
      <label>This Could Be You...</label>
      <div class="clearfix">
        <div id="commute-distance"></div>
        <div id="commute-distance3"></div>
        <div id="commute-distance2"></div>
      </div>
      <div id="map-canvas" class="clearfix"></div>
      <p class="commuteexamples"><strong>For illustrative purposes only.</strong> These routes are automatically generated from the locations typed above.</p>
    </div>
    <hr class="green-big">
    <p class="center">Please enter all segments (legs) of your commute and also include time spent walking as an additional segment (e.g. walking from the bus stop to a connecting train). Note: Feel free to check in an anticipated commute. After you submit your check-in, you are allowed to go back and make changes. The system will only record your most recent submission.</p>

    <div class="row wr-day">
      <div class="headingthing">
        <h2>Your Walk/Ride Day commute</h2>
      </div>
      <div class="col-sm-6">
        <div class="to-work">
        <center>
        <h4>FROM Home TO Work</h4>
        <hr class="green">
        </center>

        <div class="legs-wrapper">
        {% for form in WRTW_formset %}
            <div id="{{ form.prefix }}-row" class="leggedrow">

              {{ form }}
            </div>
        {% endfor %}
        </div>
        <hr>
        </div>
      </div>

      <div class="col-sm-6">
      <div class="from-work">
        <center>
        <h4>FROM Work TO Home</h4><hr class="green"></center>
        {{ wrday_copy }}

        <div class="legs-wrapper">
        {% for form in WRFW_formset %}
            <div id="{{ form.prefix }}-row" class="leggedrow">

              {{ form }}
            </div>
        {% endfor %}
        </div>
      <hr>
      </div>
      </div>
    </div>

    <!-- <div class="row">
    <hr class="green">
      <div class="col-sm-12">
      {{ commute_copy }}
      </div>
    </div> -->

    <div class="row normal-day">
      <div class="headingthing">
        <h2>Your normal commute</h2>
      </div>
      <div class="col-sm-12">
      {{ commute_copy }}
      </div>
      <div class="col-sm-6 normal-legs">
        <div class="to-work">

        <center>
        <h4>FROM Home TO Work</h4><hr class="green">
        </center>

        <div class="legs-wrapper">
        {% for form in NormalTW_formset %}
            <div id="{{ form.prefix }}-row" class="leggedrow">

              {{ form }}
            </div>
        {% endfor %}
        </div>
        <hr>
      </div>
      </div>

      <div class="col-sm-6 normal-legs">
      <div class="from-work">
        <center>
        <h4>FROM Work TO Home</h4><hr class="green"></center>
        {{ normal_copy }}

        <div class="legs-wrapper">
        {% for form in NormalFW_formset %}
            <div id="{{ form.prefix }}-row" class="leggedrow">

              {{ form }}
            </div>
        {% endfor %}
        </div>
      <hr>
      </div>
      </div>

    </div>
    <hr class="green-big">
    {% for field in extra_form %}
      <div class="form-group {% if field.errors %}has-error{% endif %}">
        <div class="col-sm-5">
          {{ field.label_tag }}
        </div>
        <div class="col-sm-7">
          {{ field }}
          {% if field.errors %}
            <div class="help-block">
            {% for error in field.errors %}
              {{ error|escape }}<br>
            {% endfor %}
            </div>
          {% endif %}
        </div>

      </div>
    {% endfor %}

    {{ NormalTW_formset.management_form }}
    {{ NormalFW_formset.management_form }}
    {{ WRTW_formset.management_form }}
    {{ WRFW_formset.management_form }}

    <center>
    {% if form.errors or WRFW_formset.errors or WRTW_formset.errors or NormalFW_formset.errors or NormalTW_formset.errors %}
      <div class="alert alert-danger" role="alert">Oops! Please finish completing your checkin.</div>
    {% endif %}
    <div id="validation1" class="alert alert-danger" role="alert"></div>
    <div id="validation2" class="alert alert-danger" role="alert"></div>
    <div id="confirmation" class="alert alert-success" role="alert">Almost there! Click below to finish.</div>
    <button class="cool-button button--ujarak" type="submit" name="action" value="action">
      Submit your checkin!
    </button>
    </center>

  </fieldset>
</form>

{% endblock %}
